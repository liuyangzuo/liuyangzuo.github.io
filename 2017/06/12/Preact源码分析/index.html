<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>Preact源码分析 • 刘哈哈的碎碎念</title><meta name="description" content="Preact源码分析 - 刘哈哈"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="https://unpkg.com/nanoreset/nanoreset.min.css"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="刘哈哈的碎碎念"></head><body><div class="wrap" id="barba-wrapper"><header><h1 class="branding"><a href="/" title="刘哈哈的碎碎念"><img class="logo-image" src="/logo.jpg" alt="logo"></a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link no-barba" href="/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/about" target="_self">ABOUT</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="https://github.com/liuyangzuo" target="_blank">GITHUB</a></li></ul></header><div class="barba-container"><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Preact源码分析</h1><div class="post-info"><a></a>2017-06-12</div><div class="post-content"><h2 id="1-基本知识"><a href="#1-基本知识" class="headerlink" title="1.基本知识"></a>1.基本知识</h2><h3 id="1-1-JSX简介"><a href="#1-1-JSX简介" class="headerlink" title="1.1 JSX简介"></a>1.1 JSX简介</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (&lt;div&gt;APP&lt;/div&gt;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="1-2-Vnode-hyperscript-Rreact-CreateElement-h-babel简介"><a href="#1-2-Vnode-hyperscript-Rreact-CreateElement-h-babel简介" class="headerlink" title="1.2 Vnode hyperscript/Rreact.CreateElement/h/babel简介"></a>1.2 Vnode hyperscript/Rreact.CreateElement/h/babel简介</h3><h3 id="1-3-0-Preact-h-‘div’-children-Preact-h-‘div’-children-区别"><a href="#1-3-0-Preact-h-‘div’-children-Preact-h-‘div’-children-区别" class="headerlink" title="1.3 (0,Preact.h)(‘div’,{},[children])  /  Preact.h(‘div’,{},[children])区别"></a>1.3 (0,Preact.h)(‘div’,{},[children])  /  Preact.h(‘div’,{},[children])区别</h3><h2 id="2-Preact-Component"><a href="#2-Preact-Component" class="headerlink" title="2.Preact  Component"></a>2.Preact  Component</h2><h3 id="2-1-Preact-Component-实例-Stateless-Component-Dump-Component-Smart-Component简介"><a href="#2-1-Preact-Component-实例-Stateless-Component-Dump-Component-Smart-Component简介" class="headerlink" title="2.1 Preact Component 实例/ Stateless Component / Dump Component/ Smart Component简介"></a>2.1 Preact Component 实例/ Stateless Component / Dump Component/ Smart Component简介</h3><h3 id="2-2-Component基类实现-自定义Compotent和基类的关系-Stateless-Component如何实现"><a href="#2-2-Component基类实现-自定义Compotent和基类的关系-Stateless-Component如何实现" class="headerlink" title="2.2 Component基类实现/自定义Compotent和基类的关系/Stateless Component如何实现"></a>2.2 Component基类实现/自定义Compotent和基类的关系/Stateless Component如何实现</h3><h3 id="2-3-Component细节，state-props-dirty-disable"><a href="#2-3-Component细节，state-props-dirty-disable" class="headerlink" title="2.3 Component细节，state? props? dirty? disable?"></a>2.3 Component细节，state? props? dirty? disable?</h3><h2 id="3-初次渲染"><a href="#3-初次渲染" class="headerlink" title="3 初次渲染"></a>3 初次渲染</h2><h3 id="3-1-TextNode-DOM-Node-Preact-Component-构建简介"><a href="#3-1-TextNode-DOM-Node-Preact-Component-构建简介" class="headerlink" title="3.1 TextNode/DOM Node/Preact Component 构建简介"></a>3.1 TextNode/DOM Node/Preact Component 构建简介</h3><h3 id="3-2-Preact-Component-构建细节-buildComponentFromVNode-setComponentProps-renderComponent"><a href="#3-2-Preact-Component-构建细节-buildComponentFromVNode-setComponentProps-renderComponent" class="headerlink" title="3.2 Preact Component 构建细节(buildComponentFromVNode, setComponentProps, renderComponent)"></a>3.2 Preact Component 构建细节(buildComponentFromVNode, setComponentProps, renderComponent)</h3><h3 id="3-3-Preact-Component-与DOM如何建立映射-innerDiffNode"><a href="#3-3-Preact-Component-与DOM如何建立映射-innerDiffNode" class="headerlink" title="3.3 Preact Component 与DOM如何建立映射(innerDiffNode)"></a>3.3 Preact Component 与DOM如何建立映射(innerDiffNode)</h3><h3 id="3-4-事件处理-style-class-dangerouslySetInnerHTML"><a href="#3-4-事件处理-style-class-dangerouslySetInnerHTML" class="headerlink" title="3.4 事件处理/ style/class/dangerouslySetInnerHTML"></a>3.4 事件处理/ style/class/dangerouslySetInnerHTML</h3><h2 id="4-更新渲染-setState"><a href="#4-更新渲染-setState" class="headerlink" title="4.更新渲染(setState)"></a>4.更新渲染(setState)</h2><h3 id="4-1-diff原则和机制介绍"><a href="#4-1-diff原则和机制介绍" class="headerlink" title="4.1 diff原则和机制介绍"></a>4.1 diff原则和机制介绍</h3><h3 id="4-2-更新DOM细节"><a href="#4-2-更新DOM细节" class="headerlink" title="4.2 更新DOM细节"></a>4.2 更新DOM细节</h3><h3 id="4-3-更新attributes细节"><a href="#4-3-更新attributes细节" class="headerlink" title="4.3 更新attributes细节"></a>4.3 更新attributes细节</h3><h2 id="5-setStatex细节"><a href="#5-setStatex细节" class="headerlink" title="5.setStatex细节"></a>5.setStatex细节</h2><h3 id="5-1同步？异步？forceUpdate-no-render"><a href="#5-1同步？异步？forceUpdate-no-render" class="headerlink" title="5.1同步？异步？forceUpdate? no render?"></a>5.1同步？异步？forceUpdate? no render?</h3><h2 id="6-卸载"><a href="#6-卸载" class="headerlink" title="6.卸载"></a>6.卸载</h2><h3 id="6-1-DOM卸载"><a href="#6-1-DOM卸载" class="headerlink" title="6.1 DOM卸载"></a>6.1 DOM卸载</h3><h3 id="6-2-Preact-Component卸载"><a href="#6-2-Preact-Component卸载" class="headerlink" title="6.2 Preact Component卸载"></a>6.2 Preact Component卸载</h3><h2 id="7-生命周期实现"><a href="#7-生命周期实现" class="headerlink" title="7.生命周期实现"></a>7.生命周期实现</h2><h3 id="7-1生命周期介绍"><a href="#7-1生命周期介绍" class="headerlink" title="7.1生命周期介绍"></a>7.1生命周期介绍</h3><h3 id="7-2生命周期实现细节"><a href="#7-2生命周期实现细节" class="headerlink" title="7.2生命周期实现细节"></a>7.2生命周期实现细节</h3><h2 id="8-番外"><a href="#8-番外" class="headerlink" title="8.番外"></a>8.番外</h2><h3 id="8-1递归diffLevel-hydrating-svg"><a href="#8-1递归diffLevel-hydrating-svg" class="headerlink" title="8.1递归diffLevel/hydrating/svg"></a>8.1递归diffLevel/hydrating/svg</h3><h3 id="8-2options-hook"><a href="#8-2options-hook" class="headerlink" title="8.2options hook"></a>8.2options hook</h3><h3 id="8-3性能相关-splitText"><a href="#8-3性能相关-splitText" class="headerlink" title="8.3性能相关 splitText ?"></a>8.3性能相关 splitText ?</h3><h3 id="8-4组件回收collectComponent"><a href="#8-4组件回收collectComponent" class="headerlink" title="8.4组件回收collectComponent"></a>8.4组件回收collectComponent</h3><h2 id="9-总结-图解"><a href="#9-总结-图解" class="headerlink" title="9.总结/图解"></a>9.总结/图解</h2></div></article></div></main><footer><div class="paginator"><a class="prev" href="/2017/07/01/Preact Router实现原理/">prev</a><a class="next" href="/2017/06/07/react swipe实现/">next</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'liuyangzuo-github-io';
var disqus_identifier = '2017/06/12/Preact源码分析/';
var disqus_title = 'Preact源码分析';
var disqus_url = 'http://liuyangzuo.github.io/2017/06/12/Preact源码分析/';
(function () {
    var dsq = document.createElement('script'); dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//liuyangzuo-github-io.disqus.com/count.js" async></script><div class="copyright"><script src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><p>&copy; 2014-2017 <a href="http://liuyangzuo.github.io">刘哈哈</a><span id="busuanzi_container_site_pv">&nbsp;&nbsp;&nbsp;🐵&nbsp;&nbsp;</span><span id="busuanzi_value_site_pv">次<br>Powered by <a href="https://hexo.io/" rel="noreferrer" target="_blank">Hexo</a></span></p></div></footer></div></div><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-106126178-1']);
_gaq.push(['_trackPageview']);

(function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script><script src="https://cdnjs.cloudflare.com/ajax/libs/barba.js/1.0.0/barba.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
    Barba.Pjax.start()
})</script></body></html>