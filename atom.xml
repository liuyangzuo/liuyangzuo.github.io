<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>åˆ˜å“ˆå“ˆçš„ç¢ç¢å¿µ</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://liuyangzuo.github.io/"/>
  <updated>2018-06-02T09:30:35.844Z</updated>
  <id>http://liuyangzuo.github.io/</id>
  
  <author>
    <name>åˆ˜å“ˆå“ˆ</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>React Overview</title>
    <link href="http://liuyangzuo.github.io/2018/06/02/React%20Overview/"/>
    <id>http://liuyangzuo.github.io/2018/06/02/React Overview/</id>
    <published>2018-06-01T16:00:00.000Z</published>
    <updated>2018-06-02T09:30:35.844Z</updated>
    
    <content type="html"><![CDATA[<p>   ç¬¬ä¸€æ¬¡æ¥è§¦Reactçš„æ—¶å€™æ˜¯è¿˜æ˜¯15å¹´æˆ‘åœ¨å¤©çŒ«å®ä¹ æ—¶å€™ï¼Œæ¯•ä¸šä¹‹åä¸€ç›´å†™Reactæœ‰2å¹´çš„æ—¶é—´äº†ï¼Œä»0.13ç‰ˆæœ¬åˆ°ç°åœ¨16.4.0ä¸€ç›´åœ¨è·Ÿè¿›ï¼Œå¹¶ä¸”æŠ•å…¥å¤§é‡çš„ç²¾åŠ›æ·±å…¥å­¦ä¹ ï¼Œå¯¹Reactç–¯ç‹‚çƒ­çˆ±ï¼Œç—´è¿·ï¼Œè‡ªå·±å¯¹setState, Transaction, Diffè¿‡ç¨‹, Virtual DOM, LifeCycle, Dumb Components, Smart Components, é«˜é˜¶ç»„ä»¶HOC, context, äº‹ä»¶ç³»ç»ŸSyntheticEvent, React Motion, Redux, React Redux, React Router, React SSRçš„<strong>å®ç°åŸç†</strong>éƒ½æœ‰è¾ƒå¥½çš„ç†è§£ï¼Œæ‰“ç®—å†™20+ç¯‡æ–‡ç« è¿›è¡Œæ€»ç»“å›é¡¾ï¼Œç”¨è¨€ç®€æ„èµ…çš„è¯­è¨€è¡¨è¿°æ ¸å¿ƒæ¦‚å¿µå’ŒåŸç†ï¼Œé»˜è®¤ä½ å·²ç»å­¦è¿‡Reactæˆ–è€…å†™è¿‡ä¸€äº›Reactåº”ç”¨ï¼Œæƒ³è¿›ä¸€æ­¥å¯¹æå‡å¯¹Reactç†è§£ï¼Œæœ¬èº«å†™ä¸œè¥¿ä¹Ÿæ˜¯å¯¹æˆ‘è‡ªå·±æ¸©æ•…è€ŒçŸ¥æ–°çš„è¿‡ç¨‹ã€‚</p><p>â€‹   äº†è§£Reactä¹‹å‰ï¼Œæˆ‘ä»¬è®¨è®ºä¸€äº›çŸ¥è¯†ç‚¹ï¼ŒåŸºç¡€çš„æ¦‚å¿µï¼Œå¯¹ç†è§£ReactåŸç†æœ‰å¾ˆå¤§çš„å¥½å¤„ã€‚</p><h4 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1 ç®€å•çš„HTMLæ ‡ç­¾</span></div><div class="line"><span class="keyword">const</span> element = &lt;h1 id="hello"&gt;Hello, React!&lt;br/&gt;&lt;/h1&gt;;</div><div class="line"></div><div class="line"><span class="comment">// 2 è‡ªå®šä¹‰ç»„ä»¶(components)</span></div><div class="line"><span class="keyword">const</span> content = <span class="string">'React'</span>;</div><div class="line"><span class="keyword">const</span> customCompenent = &lt;CustomCompenent&gt;&#123;content&#125;&lt;/CustomCompenent&gt;;</div></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç å°±æ˜¯ä¸€æ®µJSXè¡¨è¾¾å¼(XML-like expression)ï¼ŒJSXé‡Œé¢å¯ä»¥å†™ä¸€äº›å˜é‡ï¼Œè¡¨è¾¾å¼æˆ–è€…ä¸€äº›JSçš„è®¡ç®—ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚å®ƒå°†è¢«ç¼–è¯‘æˆfunction callï¼Œå½¢å¼å¦‚ä¸‹ï¼Œè¿™ä¸ªè¿‡ç¨‹æœ‰ä¸ªå«<code>hyperscript</code>çš„æ¦‚å¿µï¼Œå¯ä»¥è‡ªè¡ŒæŸ¥é˜…ä¸€ç•ªã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">h</span>(<span class="params">nodeName, atttibutes, ...children</span>)</span>&#123; <span class="comment">/* ...å…ˆä¸å…³å¿ƒhå‡½æ•°çš„å®ç° */</span>&#125;;</div><div class="line"><span class="comment">// jsxé€šè¿‡Babelç¼–è¯‘åçš„function callå½¢å¼ï¼Œå…¶å®h()å°±æ˜¯ç±»ä¼¼React.createElement()</span></div><div class="line"><span class="comment">// 1 ç®€å•å½¢å¼</span></div><div class="line">h(<span class="string">'h1'</span>, &#123;<span class="attr">id</span>: <span class="string">'hello'</span>&#125;, </div><div class="line">  <span class="string">'Hello, React'</span>, </div><div class="line">  h(<span class="string">'br'</span>)</div><div class="line">);</div><div class="line"><span class="comment">// 2 è‡ªå®šä¹‰ç»„ä»¶å½¢å¼ï¼ŒCustomCompenentæ˜¯è‡ªå®šä¹‰ç»„ä»¶ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªfunction</span></div><div class="line">h(CustomCompenent, <span class="string">'hello react'</span>);</div></pre></td></tr></table></figure><h4 id="Virtual-DOM"><a href="#Virtual-DOM" class="headerlink" title="Virtual DOM"></a>Virtual DOM</h4><p>  Virtual DOMæ˜¯ä¸€ä¸ªè¢«è¯´çƒ‚çš„è¯é¢˜ï¼Œä¸€å¥è¯<code>Virtual DOMå°±æ˜¯JavaScript Object</code>ã€‚å¼•å…¥Virtual DOMçš„åŸå› å¾ˆç®€å•ï¼Œæˆ‘ä»¬çŸ¥é“DOMæ“ä½œæ˜¯è€—è´¹æ€§èƒ½(è¿™å¥è¯æ€»è¢«æèµ·ï¼Œå…¶å®å¾ˆå¥½å‘ç°å®ƒæ˜¯ååˆ†è€—è´¹æ€§èƒ½çš„,å¯ä»¥å†™ä¸€å°æ®µä»£ç æ¥æµ‹è¯•DOMå¢åˆ æ”¹æŸ¥çš„æ—¶é—´)ï¼ŒReactå›¢é˜Ÿçš„æƒ³æ³•ç®€å•çº¯ç²¹ï¼Œç”¨JavaScriptå¯¹è±¡æ¥æè¿°è¡¨ç¤ºDOMï¼Œæ¡†æ¶å±‚é¢ä¸Šå¸®ä½ è¿›è¡Œæ‰¹é‡çš„diffï¼Œpatchè¿‡ç¨‹ï¼Œç»Ÿä¸€çš„æœºåˆ¶å¸®ä½ è¿›è¡ŒDOMçš„åˆ›å»ºå’Œæ›´æ–°(åé¢æˆ‘ä¼šå†™å…·ä½“å®ç°åŸç†, under the the hood)ï¼ŒèŠ‚çœå¼€é”€ï¼Œä»è€Œè·å¾—æ€§èƒ½ä¸Šçš„æ”¶ç›Šï¼ˆå®˜æ–¹ä¹Ÿæä¾›äº†React Prefæ¥æŸ¥çœ‹æ€§èƒ½æŒ‡æ ‡ï¼‰ã€‚æ€»ä¹‹Reactå¸®ä½ åšäº†ä»Virtual DOMåˆ°çœŸå®DOMçš„é«˜æ•ˆæ˜ å°„è¿‡ç¨‹ï¼Œä½ æ— éœ€ä¸“æ³¨DOMï¼ŒæŠŠå…³æ³¨ç‚¹æ”¾åœ¨å¦‚ä½•æ›´æ”¹stateï¼Œ View = f (state)ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// DOM æ“ä½œ test</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createNodeFactory</span>(<span class="params">num</span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span>( <span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; num; i ++) &#123;</div><div class="line">   <span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>);</div><div class="line">   <span class="keyword">var</span> text = <span class="built_in">document</span>.createTextNode(<span class="string">'text'</span> + i);</div><div class="line">   div.appendChild(text);</div><div class="line">   <span class="built_in">document</span>.body.appendChild(div)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createArrayFatory</span>(<span class="params">num</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> arr = [];</div><div class="line">  <span class="keyword">for</span> ( <span class="keyword">let</span> i = <span class="number">0</span>; i &lt; num ; i ++)&#123;</div><div class="line">    arr[i] = i;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> arr;</div><div class="line">&#125;</div><div class="line">  </div><div class="line"><span class="keyword">var</span> t1 = <span class="keyword">new</span> <span class="built_in">Date</span>;</div><div class="line">createNodeFactory(<span class="number">100000</span>);    </div><div class="line"><span class="keyword">var</span> t2 = <span class="keyword">new</span> <span class="built_in">Date</span>;</div><div class="line">createArrayFatory(<span class="number">100000</span>);    </div><div class="line"><span class="keyword">var</span> t3= <span class="keyword">new</span> <span class="built_in">Date</span>;</div><div class="line"><span class="built_in">console</span>.log(t2 - t1); <span class="comment">// 210 </span></div><div class="line"><span class="built_in">console</span>.log(t3 - t2); <span class="comment">// 5</span></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> è¿™é‡Œæ —å­è™½ç„¶ååˆ†ä¸ä¸¥è°¨ï¼Œè¿˜æœ‰ä»€ä¹ˆcreateDocumentFragmentï¼Œä½†æ˜¯å…¶å®ä¹Ÿæ˜¯å¾®ä¹å…¶å¾®çš„ï¼Œè¿™ä¸ªæ —å­å¯ä»¥è¯´DOMçš„æ“ä½œç›¸æ¯”å•çº¯çš„jsè®¡ç®—çœŸçš„å¾ˆæ…¢ã€‚</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure><p>çœ‹çœ‹Virtual DOM åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆæ ·å­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Virtual DOM çš„çœŸå®æƒ…å†µåŸºæœ¬ç±»ä¼¼ä¸‹é¢è¿™ä¸ªæ ·å­</span></div><div class="line"><span class="keyword">var</span> vdom = &#123;</div><div class="line">   nodeName:<span class="string">'h1'</span>,</div><div class="line">   attributes: &#123; <span class="attr">id</span>:<span class="string">'hello'</span> &#125;,</div><div class="line">   children: [</div><div class="line">     <span class="string">'Hello, React!'</span>,</div><div class="line">     &#123; <span class="attr">nodeName</span>:<span class="string">'br'</span> &#125;</div><div class="line">   ]</div><div class="line"> &#125;</div><div class="line"></div><div class="line"><span class="comment">// è‡ªå®šä¹‰ç»„ä»¶</span></div><div class="line"><span class="keyword">var</span> customCompoment = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="comment">/*...*/</span>&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> vdom = &#123;</div><div class="line">   nodeName: customCompoment,</div><div class="line">   attributes: &#123;<span class="comment">/*....*/</span>&#125;,</div><div class="line">   children: [</div><div class="line">     <span class="comment">/*xxxxx*/</span></div><div class="line">   ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>   ç”¨ä¸€ä¸ªå›¾è¡¨ç¤ºè¿™ä¸€ä¸ªè¿‡ç¨‹ã€‚</p><p><img src="https://i.loli.net/2018/06/02/5b126144d9bfe.png" alt="jsx-hyperscript-vdom"></p><h4 id="Virtual-DOM-Factocy"><a href="#Virtual-DOM-Factocy" class="headerlink" title="Virtual DOM Factocy"></a>Virtual DOM Factocy</h4><p>â€‹ æ¥ä¸‹æ¥äº†è§£ä¸€ä¸‹hyperscriptçš„æ¦‚å¿µ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">h</span>(<span class="params">nodeName, attributes, ...children</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123; nodeName, attributes, children &#125;</div><div class="line">  &#125;</div><div class="line"><span class="comment">// å¯ä»¥æ ¹æ®éœ€è¦å®ç°ä½ è‡ªå·±çš„hyperscriptæ–¹æ³•ï¼Œreactå®ç°äº†è‡ªå·±çš„æ–¹æ³•å«createElement</span></div></pre></td></tr></table></figure><h4 id="Render"><a href="#Render" class="headerlink" title="Render"></a>Render</h4><p>  å‰ææˆ‘ä»¬è®¨è®ºçš„æ˜¯åŒæ­¥renderçš„èŒƒç•´ï¼Œè€ƒè™‘ä¸€ä¸‹å½“æ‹¥æœ‰ä¸€ä¸ªVNodeæ—¶å€™ï¼Œæ€ä¹ˆæ¸²æŸ“åˆ°æµè§ˆå™¨ã€‚è§‚å¯ŸVNodeçš„ç»“æ„ï¼ŒVNodeå·²ç»å‘Šè¯‰æˆ‘ä»¬äº†åç§°(tag, componment)ï¼Œå±æ€§ï¼Œå­èŠ‚ç‚¹ï¼Œè®¨è®ºåˆ°å­èŠ‚ç‚¹ç¬é—´å°±è¦æƒ³åˆ°æœ‰é€’å½’æ¸²æŸ“çš„ååº”ï¼Œå°è¯•å†™ä¸‹ç®€å•çš„renderå‡½æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">vnode</span>) </span>&#123;</div><div class="line">  <span class="comment">/* æˆ‘ä»¬è¿˜è¦åˆ¤æ–­ä¸€ä¸‹vnodeç±»å‹ï¼Œ</span></div><div class="line"><span class="comment">     case 1 æ–‡æœ¬</span></div><div class="line"><span class="comment">     case 2 å…ƒç´ tag</span></div><div class="line"><span class="comment">     case 3 è‡ªå®šä¹‰ç»„ä»¶ï¼Œå…ˆå¿½ç•¥å§</span></div><div class="line"><span class="comment">  */</span></div><div class="line">   <span class="keyword">if</span>(<span class="keyword">typeof</span> vnode === <span class="string">'string'</span>) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="built_in">document</span>.createTextNode(vnode);</div><div class="line">   &#125;</div><div class="line">    </div><div class="line">   <span class="keyword">let</span> node = <span class="built_in">document</span>.createElement(vnode.nodeName);</div><div class="line"></div><div class="line">   <span class="keyword">for</span> (attribute <span class="keyword">in</span> vnode.attributes) &#123;</div><div class="line">      node.setAttribute(attribute, vnode.attributes[attribute]);</div><div class="line">   &#125;</div><div class="line">   <span class="comment">// çŸ«æ­£</span></div><div class="line">   vnode.children = vnode.children || [];</div><div class="line"></div><div class="line">   <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; vnode.children.length; i++ )&#123;</div><div class="line">       node.appendChild(render(vnode.children[i]));</div><div class="line">   &#125;</div><div class="line">    </div><div class="line">   <span class="keyword">return</span> node;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="Attributes-or-Properties"><a href="#Attributes-or-Properties" class="headerlink" title="Attributes or Properties"></a>Attributes or Properties</h4><p>  åœ¨renderå°èŠ‚ä¸­æˆ‘ä»¬è®¨è®ºçš„åŸºæœ¬æ˜¯é¦–æ¬¡æ¸²æŸ“çš„æƒ…å†µï¼Œä¹Ÿæ¸²æŸ“äº†çœŸå®çš„DOMèŠ‚ç‚¹ï¼Œæ¥ä¸‹é‡Œè®¨è®ºä¸€ä¸‹DOMå…ƒç´ çš„å±æ€§ã€‚DOMå±æ€§å¯èƒ½æ˜¯é‡æ–°è®¾ç½®äº†ä¸€ä¸ªæ–°çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯åŸæœ‰çš„å±æ€§å‘ç”Ÿäº†updateã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">diffProps</span>(<span class="params">node, vnode</span>) </span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> property <span class="keyword">in</span> vnode.attributes) &#123;</div><div class="line">       <span class="keyword">let</span> value = vnode.attributes[property];</div><div class="line">        <span class="keyword">if</span>(property <span class="keyword">in</span> node) &#123;</div><div class="line">            node.property = value;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            node.setAttributes(property, value)</div><div class="line">        &#125;   </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="Diffing"><a href="#Diffing" class="headerlink" title="Diffing"></a>Diffing</h4><p>  å†è®¨è®ºä¸€ä¸‹diffè¿‡ç¨‹ï¼Œå…ˆçœ‹çœ‹Virtual DOM , å’Œä½¿ç”¨renderå‡½æ•°ç”ŸæˆçœŸå®çš„DOMæƒ…å†µ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Virtual DOM</span></div><div class="line"><span class="keyword">var</span> vdom = &#123;</div><div class="line">    nodeName: <span class="string">'div'</span>,</div><div class="line">    attributes: &#123;</div><div class="line">      key: <span class="string">'03'</span>,</div><div class="line">    &#125;,</div><div class="line">    children: [</div><div class="line">      <span class="string">'text node '</span></div><div class="line">    ]</div><div class="line">&#125;</div><div class="line"><span class="comment">// render ä¹‹åæˆ‘ä»¬ç”Ÿæˆçš„çœŸå®DOM</span></div><div class="line"><span class="comment">// Actual DOM</span></div><div class="line">Element(</div><div class="line">   nodeName: <span class="string">'div'</span>,</div><div class="line">    attributes: &#123;</div><div class="line">      getItem(<span class="string">'key'</span>),</div><div class="line">      setItem(<span class="string">'key'</span>, value)</div><div class="line">    &#125;,</div><div class="line">    childNodes: [</div><div class="line">      TextNMode(<span class="string">'text node'</span>)</div><div class="line">    ]</div><div class="line">)</div></pre></td></tr></table></figure><p>â€‹ diffçš„è¿‡ç¨‹å…ˆä¸å±•å¼€è¯´ï¼Œåé¢ä»‹ç»ï¼Œä½†æ˜¯å¯ä»¥è¯´diffçš„æ€è·¯ï¼Œdiffå¾ˆæ˜æ˜¾æœ‰ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹è¦éå†å­èŠ‚ç‚¹çš„æƒ…å†µï¼Œdiffè¦æŸ¥çœ‹DOMå±æ€§å•Šï¼Œäº‹ä»¶ç›‘å¬å•Š(å¦‚æœäº‹ä»¶æ˜¯ç›´æ¥ç»‘å®šå…ƒç´ ä¸Š,reactå¹¶ä¸æ˜¯è¿™æ ·åšçš„)ï¼ŒtextNodeå˜åŒ–ï¼ŒèŠ‚ç‚¹æ˜¯å¦åˆ é™¤ï¼Œæ˜¯å¦æ–°å¢ï¼Œå®—æ—¨æ˜¯æˆ‘ä»¬å¯ä»¥å¾—åˆ°oldVnodeå’ŒnewVnodeï¼Œæ‰¾åˆ°diifçš„partial Object å†patchï¼Œå®ŒæˆoldActualDOMåˆ°newActualDOMçš„æ˜ å°„æ›´æ–°ï¼Œdiffè¿‡ç¨‹æ˜¯å†³å®šReactæ¶æ€§èƒ½çš„æœ€é‡è¦å½±å“å› ç´ ï¼Œä¹Ÿæ˜¯æœ€å¤æ‚çš„åœ°æ–¹æ²¡æœ‰ä¹‹ä¸€ï¼Œæ¶‰åŠåˆ°å¦‚ä½•è®¾è®¡ï¼Œä½¿ç”¨ä»€ä¹ˆdiffç®—æ³•ï¼Œå¼•å…¥äº†keyæ ‡è®°çš„ä¼˜åŒ–ç­‰ï¼Œå¤§æœ‰æ–‡ç« ã€‚</p><h4 id="React-Component"><a href="#React-Component" class="headerlink" title="React Component"></a>React Component</h4><p>  äº†è§£åŸºç¡€æ¦‚å¿µä¹‹åï¼Œå¼€å§‹Reactè¯é¢˜ï¼Œå…ˆçœ‹çœ‹ES5/ES6çš„å†™æ³•ï¼ŒECMAScriptåœ¨å‘å±•ï¼ŒReactä¹Ÿå‘å±•äº†å‡ å¹´ï¼Œç»å†äº†ES5åˆ°ES6çš„å‡çº§ï¼ŒES6çš„ Componmentå¸¦æ¥çš„ä¸€äº›æ–°çš„å°ç‰¹æ€§ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5</span></div><div class="line"><span class="keyword">var</span> CartES5 = React.createClass(&#123;</div><div class="line">    getDefaltProps: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> &#123;</div><div class="line">           key1: <span class="string">'value1'</span>,</div><div class="line">           key2: <span class="string">'value2'</span>,</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    </div><div class="line">    getInitialState: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> &#123;</div><div class="line">            key3: <span class="string">'value3'</span>,</div><div class="line">            key4: <span class="string">'value4'</span>,</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    </div><div class="line">    handleClick: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        </div><div class="line">    &#125;,</div><div class="line">    </div><div class="line">    handleOnChage: <span class="function"><span class="keyword">function</span>(<span class="params">inputIndex, e</span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> state = &#123;&#125;;</div><div class="line">        state[<span class="string">'key'</span> + inpuIndex] = e.target.value;</div><div class="line">        <span class="keyword">this</span>.setState(state);</div><div class="line">        </div><div class="line">    &#125;,</div><div class="line">    </div><div class="line">    render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="keyword">return</span> (&lt;div onClick=&#123;this.handleClick&#125;&gt;</div><div class="line">              &lt;div&gt;Cart Component&lt;/div&gt;</div><div class="line">              &lt;input onChange=&#123;this.handleOnChage&#125;/&gt;</div><div class="line">             &lt;/div&gt;);</div><div class="line">  &#125;,</div><div class="line">    componentWillMount: function() &#123; â€¦ &#125;</div><div class="line">&#125;)</div><div class="line">/*</div><div class="line">  ES6 ä½¿ç”¨Classæ¥å®šä¹‰ç»„ä»¶ï¼Œç”Ÿå‘½å‘¨æœŸcomponmentWillMountçš„åŠŸèƒ½å¯åœ¨constructorå®Œæˆï¼Œ</div><div class="line">  äº‹ä»¶ç»‘å®šåœ¨constructorä¸­ä¸€æ¬¡æ€§ç»‘å®šï¼Œå˜é‡è§£æ„, ç®­å¤´å‡½æ•°ï¼Œæ¨¡ç‰ˆå­—ç¬¦ä¸²ç­‰æ–°çš„ç‰¹æ€§å¯ä»¥ä½¿ç”¨ã€‚</div><div class="line">*/</div><div class="line">class CartES6 extends React.Componment &#123;</div><div class="line">    constructor(props)&#123;</div><div class="line">        super(props);</div><div class="line">        this.handleClick = this.handleClick.bind(this);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    static defaultProps = &#123;</div><div class="line">       key1: 'value1',</div><div class="line">       key2: 'value2', </div><div class="line">    &#125;</div><div class="line">        </div><div class="line">    state = &#123;</div><div class="line">      key3: 'value3',</div><div class="line">      key4: 'value4',      </div><div class="line">    &#125;</div><div class="line">        </div><div class="line">    handleClick = (e) =&gt; &#123;        </div><div class="line">        </div><div class="line">    &#125;</div><div class="line">        </div><div class="line">    handleOnChage(inputIndex, e) &#123;</div><div class="line">      this.setState(&#123;[`key$&#123;inputIndex&#125;`]: e.target.value&#125;);</div><div class="line">    &#125;</div><div class="line">        </div><div class="line">    render() &#123;</div><div class="line">      // æ”¯æŒäº†å˜é‡è§£æ„ææ„</div><div class="line">      const &#123; className, ...opts &#125; = this.props;</div><div class="line">      return (&lt;div onClick=&#123;this.handleClick&#125;&gt;</div><div class="line">                &lt;div&gt;Cart Component&lt;/div&gt;</div><div class="line">                &lt;input onChange=&#123;this.handleOnChage&#125;/&gt;</div><div class="line">                &lt;CustomComponmen &#123;...opts&#125;/&gt;              </div><div class="line">              &lt;/div&gt;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="Functional-Component"><a href="#Functional-Component" class="headerlink" title="Functional Component"></a>Functional Component</h4><p>è¿˜æœ‰ä¸€ç§ç®€å•çš„æ–¹å¼æ¥å®šä¹‰ä¸€ä¸ªç»„ä»¶ï¼Œå°±æ˜¯ä½¿ç”¨JavaSctiptçš„å‡½æ•°,è¿™ç§æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œçº¯å±•ç¤ºå‹çš„ç»„ä»¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">HelloReact</span>(<span class="params">props</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &lt;div&gt;Hello React&lt;/div&gt;</div><div class="line">&#125;</div><div class="line"><span class="comment">// ç¤¾åŒºæ¯”è¾ƒæ¨å´‡è¿™ç§å†™æ³•ï¼Œç»„ä»¶å…¶å®åˆ†å¥½å¤šç§ï¼Œå®¹å™¨ç»„ä»¶ï¼Œå±•ç¤ºå‹çš„ç»„ä»¶ï¼Œåé¢å†å†™å‡ºç»„ä»¶çš„ä¸€äº›åˆ†ç±».</span></div></pre></td></tr></table></figure><h4 id="React-Event"><a href="#React-Event" class="headerlink" title="React Event"></a>React Event</h4><p>â€‹ å¤§å¤šæ•°äººçŸ¥é“Reactçš„äº‹ä»¶ç³»ç»Ÿæ˜¯åˆæˆäº‹ä»¶(SyntheticEvent)ï¼Œæ‰€æœ‰çš„äº‹ä»¶ä½¿ç”¨äº‹ä»¶ä»£ç†åˆ°documentä¸Šï¼Œåšç»Ÿä¸€çš„äº‹ä»¶dispatchï¼Œè‡ªå·±å®ç°çš„äº‹ä»¶å†’æ³¡è¿‡ç¨‹ï¼Œé˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œé˜»æ­¢äº‹ä»¶å†’æ³¡ç­‰ï¼Œå¦å¤–Reactå›¢é˜Ÿç§°æ˜¯å®ç°çš„ç¬¦åˆè§„èŒƒçš„å¤„ç†äº†å„ç§å‚å•†äº‹ä»¶çš„å…¼å®¹æ€§é—®é¢˜ï¼Œä½†æ˜¯è¿™é‡Œé¢ä¸€ä¸ªå°æ’æ›²ï¼Œæˆ‘é—®è¿‡çš„äººæ²¡æœ‰ä¸€ä¸ªå›ç­”æ­£ç¡®çš„ï¼Œå°±æ˜¯Reactå®ç°çš„onChangeäº‹ä»¶(PS : åé¢æˆ‘å†å†™SyntheticEventå®ç°åŸç†)ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">  æŠ›å¼€Reactï¼ŒèŠä¸€èŠonChangeäº‹ä»¶,å¤§å¤šæ•°äººéƒ½ç†è§£é”™äº†inputæ ‡ç­¾çš„onChangeäº‹ä»¶ï¼ŒonChangeäº‹ä»¶è§¦å‘çš„æ—¶æœºæ˜¯valueå€¼æ”¹å˜ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯valueå€¼æ”¹å˜å‘¢ï¼Œæ˜¯å¤±å»ç„¦ç‚¹ï¼å¤±å»ç„¦ç‚¹ï¼å¤±å»ç„¦ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒonChangeäº‹ä»¶çš„çš„è§¦å‘ä¸æ˜¯æ—¶æ—¶ï¼Œæ—¶æ—¶è§¦å‘çš„äº‹ä»¶æ˜¯onInput!æ—¶æ—¶è§¦å‘çš„äº‹ä»¶æ˜¯onInput!æ—¶æ—¶è§¦å‘çš„äº‹ä»¶æ˜¯onInput.</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">InputComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(props)&#123;</div><div class="line">        <span class="keyword">super</span>(props);</div><div class="line">        <span class="keyword">this</span>.handleChange = <span class="keyword">this</span>.handleChange.bind(<span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line">    handleChange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</div><div class="line">        <span class="comment">// è¿™é‡Œçš„`e`æ˜¯synthetic event</span></div><div class="line">        <span class="built_in">console</span>.log(e.target.value);</div><div class="line">    &#125;</div><div class="line">    render()&#123;</div><div class="line">        <span class="keyword">return</span> &lt;input onChange=&#123;this.handleChange&#125;/&gt;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">/*</div><div class="line"> ä¸Šé¢çš„ä»£ç è¿è¡Œä¹‹åï¼Œæˆ‘å‘ç°consoleæ˜¯æ—¶æ—¶çš„ï¼Œæ—¢ç„¶Reactçš„äº‹ä»¶ç³»ç»Ÿæ˜¯ç¬¦åˆæ ‡å‡†çš„ï¼Œä¸ºä½•onchangeäº‹ä»¶è¡¨ç°ä¸ä¸€è‡´ï¼Œæˆ‘åœ¨github issuesä¸­æ‰¾åˆ°äº†DANçš„å›ç­”ï¼Œä¹Ÿåœ¨stackoverflowæ‰¾åˆ°äº†ç­”æ¡ˆï¼Œè¿™æ˜¯4 5å¹´å‰çš„äº‹æƒ…äº†ï¼Œä¹Ÿæ˜¯Reactå›¢é˜Ÿæœ€å¼€å§‹çš„ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºå¤§å¤šæ•°äººè§‰å¾—changeäº‹ä»¶åº”è¯¥å°±æ˜¯æ—¶æ—¶çš„ï¼Œæ‰€ä»¥Reactå›¢é˜Ÿåœ¨å®ç°æ—¶è€ƒè™‘åˆ°äº†ä¹ æƒ¯ï¼Œæ²¡æœ‰å®Œå…¨ç¬¦åˆæ ‡å‡†ã€‚</div><div class="line"> https://stackoverflow.com/questions/38256332/in-react-whats-the-difference-between-onchange-and-oninput</div><div class="line">*/</div></pre></td></tr></table></figure><p>   å†æ¥çœ‹ä¸€çœ‹æ—¶é—´äº‹ä»¶ä¼ é€’å‚æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Zoombie</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">    handleOnClick(params, e) &#123;</div><div class="line">       <span class="built_in">console</span>.log(params, e);</div><div class="line">    &#125;</div><div class="line">    render() &#123;</div><div class="line">       <span class="keyword">let</span> params = &#123;<span class="attr">test</span>: <span class="string">'test'</span>&#125;;</div><div class="line">       <span class="keyword">return</span> (&lt;div onClick=&#123;this.handleOnClick.bind(this, params)&#125;&gt;Zoombie&lt;/div&gt;)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>   å®˜æ–¹æ–‡æ¡£Handling Eventsè¿™ä¸€å°èŠ‚ï¼Œè¯´æ˜äº†ä¸€äº›æ³¨æ„äº‹é¡¹ï¼Œå…¶å®å¤§éƒ¨åˆ†äººå¹¶æ²¡æœ‰çœ‹è¿‡å§ï¼Œ<a href="https://reactjs.org/docs/handling-events.html" target="_blank" rel="external">https://reactjs.org/docs/handling-events.html</a></p><h4 id="Bind"><a href="#Bind" class="headerlink" title="Bind"></a>Bind</h4><p>  åœ¨renderå‡½æ•°å†™bindå‡½æ•°å’Œåœ¨constructorä¸­ä¸€æ¬¡bindæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿä¸ºä»€ä¹ˆè¦æ‰‹åŠ¨bindï¼Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> å®˜æ–¹æ–‡æ¡£ç»™å‡ºäº†ä¸¤ä¸ªé“¾æ¥</span></div><div class="line"><span class="comment"> 1. how functions work in JavaScript</span></div><div class="line"><span class="comment">  https://www.smashingmagazine.com/2014/01/understanding-javascript-function-prototype-bind/</span></div><div class="line"><span class="comment"> 2.MDN bind function</span></div><div class="line"><span class="comment"> https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Function/bind</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="comment">// 1.InputComponmentç»„ä»¶åœ¨constructorå‡½æ•°é‡Œé¢æœ‰ä¸€å¥bindç›¸å…³çš„, renderå‡½æ•°ç›´æ¥å°±ç”¨this.handleChange</span></div><div class="line"><span class="keyword">constructor</span>() &#123;</div><div class="line">  <span class="keyword">this</span>.handleChange = <span class="keyword">this</span>.handleChange.bind(<span class="keyword">this</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 2.ä¹Ÿå¯ä»¥ä¸åœ¨constructorç»‘å®šï¼Œç›´æ¥åœ¨renderå‡½æ•°é‡Œé¢bindï¼Œæ€ä¹ˆéƒ½æ˜¯å¯ä»¥çš„ï¼Œ</span></div><div class="line">render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;input onChage=&#123;this.handleChange.bind(this)&#125;/&gt;</div><div class="line">&#125;</div><div class="line">// 3.å¦‚æœä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œå°±å¯ä»¥ä¸ç”¨åœ¨constructorç»‘å®šï¼Œè¿™æ˜¯å› ä¸ºå’Œç®­å¤´å‡½æ•°çš„thisæœ‰å…³</div><div class="line">render() &#123;</div><div class="line">   return &lt;button onClick=&#123;(e) =&gt; this.handleClick(e)&#125;&gt;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å…ˆçœ‹ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆè¦bindï¼Œè¿™æ˜¯JavaScriptåŸºç¡€çš„ä¸€ä¸ªé—®é¢˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*bind,call,applyçš„ç”¨æ³•å†ä¸èµ˜è¿°ï¼Œçœ‹ä¸¤ä¸ªğŸŒ°*/</span></div><div class="line"><span class="comment">// ç¬¬ä¸€ä¸ªğŸŒ°</span></div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">    name: <span class="string">'javascipt'</span>,</div><div class="line">    getName: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="keyword">this</span>.name &#125;</div><div class="line">&#125;</div><div class="line">obj.getName() <span class="comment">// è¾“å‡ºäº† 'javascipt'</span></div><div class="line"><span class="keyword">var</span> fakerGetName = obj.getName;</div><div class="line">fakerGetName() <span class="comment">// undefined å› ä¸ºthisçš„æŒ‡å‘æ”¹å˜äº†ï¼Œthisæ˜¯è¿è¡Œæ—¶æ‰ç»‘å®šçš„ã€‚</span></div><div class="line"></div><div class="line"><span class="comment">// ç¬¬äºŒä¸ªğŸŒ°ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä½¿ç”¨Babelè½¬æ¢ä»£ç ï¼Œä¼šçœ‹åˆ°ç±»ä¼¼ (0, R.h)('xxx');</span></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> //ä½¿ç”¨é€—å·è¡¨è¾¾å¼å…¶å®å°±æ˜¯ä¸Šé¢ğŸŒ°ä¸€çš„æƒ…å†µ,ä¸ºäº†é‡Šæ”¾this,å…¶å® 0 || R.h ä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·çš„ç›®çš„</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">  å†çœ‹renderå‡½æ•°é‡Œé¢çš„ è¡¨è¾¾å¼onClick=&#123;this.handleClick&#125;å®é™…ä¸Šå°±æ˜¯ä¾‹å­ä¸€çš„æƒ…å†µï¼Œå°±æ˜¯èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥éœ€è¦bind</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure><p>ä¸Šé¢è®¨è®ºçš„ä¸ºä»€ä¹ˆè¦bindï¼Œæ¥ä¸‹æ¥çœ‹ç¬¬äºŒä¸ªé—®é¢˜ï¼Œä¸¤ç§bindæ–¹å¼çš„åŒºåˆ«ã€‚é¦–å…ˆå®˜ç½‘å·²ç»æ˜ç¡®æŒ‡æ˜æ¨èä½¿ç”¨åœ¨constructorå‡½æ•°ä¸­ç»‘å®šçš„æ–¹å¼ï¼Œå¦‚æœä½¿ç”¨ç®­å¤´å‡½æ•°è¿™ç§æ–¹å¼ï¼Œæ¯æ¬¡renderçš„æ—¶å€™å‡½æ•°éƒ½ä¼šè¢«åˆ›å»ºï¼Œå¦‚æœå‡½æ•°é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªcomponmentçš„æ“ä½œï¼Œè¿˜ä¼šé€ æˆä¸å¿…è¦çš„æ¸²æŸ“ï¼Œå¸¦æ¥äº†æ€§èƒ½é—®é¢˜ã€‚</p><h4 id="Key"><a href="#Key" class="headerlink" title="Key"></a>Key</h4><p> å½“æ¸²æŸ“ä¸€ä¸ªåˆ—è¡¨æ—¶å€™ä¸€å®šä¼šè®¾ç½®keyï¼Œkeyæœ‰ä¸¤ä¸ªç”¨é€”ï¼Œç¬¬ä¸€åœ¨diffè¿‡ç¨‹ä¸­æ€§èƒ½ä¼˜åŒ–çš„ï¼Œç¬¬äºŒï¼Œå’Œè‡ªå®šä¹‰äº‹ä»¶ç³»ç»Ÿçš„æ ‡è¯†æœ‰å…³ï¼Œåé¢å†å†™keyæ€ä¹ˆåšçš„diffæ€§èƒ½ä¼˜åŒ–ï¼Œæ€ä¹ˆå’Œäº‹ä»¶ç›¸å…³ï¼Œå…ˆçœ‹ä¸€äº›å¸¸è§„çš„keyæ“ä½œã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> List = [</div><div class="line">    &#123;<span class="attr">id</span>: <span class="number">10001</span>, <span class="attr">content</span>: <span class="string">'one'</span>&#125;,</div><div class="line">    &#123;<span class="attr">id</span>: <span class="number">10002</span>, <span class="attr">content</span>: <span class="string">'two'</span>&#125;,</div><div class="line">    &#123;<span class="attr">id</span>: <span class="number">10003</span>, <span class="attr">content</span>: <span class="string">'three'</span>&#125;,</div><div class="line">]</div><div class="line">Class Cart extends React.Componment &#123;</div><div class="line">    render() &#123;</div><div class="line">      <span class="keyword">return</span> (&lt;div&gt;</div><div class="line">               &#123;</div><div class="line">                 List.map((item) =&gt; &#123; </div><div class="line">                  return &lt;div key=&#123;item.id&#125;&gt;&#123;item.content&#125;&lt;/div&gt;</div><div class="line">                 &#125;)</div><div class="line">             &#125;</div><div class="line">              &lt;/div&gt;)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> - keyå’Œæ€§èƒ½ä¼˜åŒ–ç›¸å…³ï¼Œå¤§é”™ç‰¹é”™å°±æ˜¯å°±ä½¿ç”¨æ•°ç»„çš„ç´¢å¼•å½“ä½œkeyï¼Œå½“æˆ‘ä»¬è¿›è¡Œåˆ é™¤æˆ–è€…ï¼Œå¢åŠ å…ƒç´ æ—¶å€™ï¼Œkeyå‘ç”Ÿäº†å˜åŒ–ï¼Œæœ¬èº«keyæ˜¯åº”è¯¥æ˜¯å”¯ä¸€ç¨³å®šçš„è¡¨ç¤ºï¼Œdiffæ—¶æ¯”å¯¹çš„ï¼Œåœ¨ç”Ÿäº§ä¸­æ¯å½“æ¸²æŸ“ä¸€ä¸ªåˆ—è¡¨ï¼Œåç«¯è¿”å›çš„æ•°æ®åŸºæœ¬éƒ½ä¼šæœ‰å”¯ä¸€æ ‡è¯†çš„ã€‚</span></div><div class="line"><span class="comment"> - å¦‚æœæˆ‘ä»¬çš„keyè®¾ç½®ç›¸åŒï¼Œä»…ä»…ä¼šæ¸²æŸ“å‡ºä¸€ä¸ªå…ƒç´ ï¼Œä½†æ˜¯React 16.0.0 æ¸²æŸ“å‡ºäº†æ‰€æœ‰å…ƒç´ ï¼ŒæŠ¥äº†ä¸€ä¸ªWarning: Each child in an array or iterator should have a unique 'key' prop.</span></div><div class="line"><span class="comment"> - å¦‚æœä¸è®¾ç½®keyåŒæ ·ä¼šæŠ¥ä¸Šé¢</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure><h4 id="Refs"><a href="#Refs" class="headerlink" title="Refs"></a>Refs</h4><p>   ä½¿ç”¨Reactæˆ‘ä»¬åŸºæœ¬ä¸ä¼šæ¥è§¦åˆ°DOMï¼Œå› ä¸ºæ¡†æ¶å¸®ä½ æ›´æ–°è§†å›¾ï¼Œä½†æœ‰äº›æƒ…å†µï¼Œæˆ‘ä»¬ç¡®å®è¦æ“ä½œDOMï¼Œå¯ä»¥é€šè¿‡refsæ¥è·å–DOMçš„å¼•ç”¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> ä»€ä¹ˆæ—¶å€™æˆ‘ä»¬å¯èƒ½ä¼šéœ€è¦ä½¿ç”¨Refså‘¢ ï¼Ÿ</span></div><div class="line"><span class="comment"> - Managing focus, text selection, or media playback.</span></div><div class="line"><span class="comment"> - åŠ¨ç”»</span></div><div class="line"><span class="comment"> - ä½¿ç”¨ç¬¬ä¸‰æ–¹ç±»åº“</span></div><div class="line"><span class="comment">*/</span></div><div class="line"><span class="comment">// å…ˆæ˜ç¡®ä¸€ç‚¹ä¸è¦è¿‡æ¸¡ä½¿ç”¨ref</span></div></pre></td></tr></table></figure><p>ä½¿ç”¨refæœ‰å‡ ç§æ–¹å¼ </p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 1 - æœ€å¤è€çš„æ–¹å¼ ref="xxx"</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cart</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  componentDidMount ()&#123;</div><div class="line">     <span class="built_in">console</span>.log(<span class="keyword">this</span>.inputRef)</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;input ref=<span class="string">"inputRef"</span> onChange=&#123;<span class="keyword">this</span>.handleChange&#125;/&gt;</div><div class="line">      &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    )</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line">// è¿™ä¸ªå¤è€çš„æ–¹æ³•å°†è¢«åºŸå¼ƒäº†ï¼Œæœ‰ä¸€äº›å‘https://github.com/facebook/react/pull/8333#issuecomment-271648615</div><div class="line"></div><div class="line"><span class="comment">// 2 - Callback Refsï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒæ¨èçš„refå§¿åŠ¿</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cart</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.setInputRef = <span class="function"><span class="params">element</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">this</span>.inputRef = element;      </div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  handleChange() &#123;</div><div class="line">        </div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;input ref=&#123;<span class="keyword">this</span>.setInputRef&#125; onChange=&#123;<span class="keyword">this</span>.handleChange&#125;/&gt;</div><div class="line">      &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    )</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">/</span><span class="regexp">/ 3 - Creating Refs Reactæ–°å¢åŠ çš„API</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">class Cart extends React.Component &#123;</span></div><div class="line"><span class="regexp">  constructor() &#123;</span></div><div class="line"><span class="regexp">   this.inputRef = React.createRef();</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">  handleChange() &#123;</span></div><div class="line"><span class="regexp">    /</span><span class="regexp">/ this.inputRef.current ..  DOMå¼•ç”¨</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">  render() &#123;</span></div><div class="line"><span class="regexp">    return (</span></div><div class="line"><span class="regexp">      &lt;div&gt;</span></div><div class="line"><span class="regexp">        &lt;input ref=&#123;this.setInputRef&#125; onChange=&#123;this.handleChange&#125;/</span>&gt;</div><div class="line">      &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    )</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp">/</span>* å¼•ç”¨æ–‡æ¡£çš„ä¸€æ®µè¯,</div><div class="line">React will assign the current property <span class="keyword">with</span> the DOM element when the component mounts, and assign it back to <span class="literal">null</span> when it unmounts. ref updates happen before componentDidMount or componentDidUpdate lifecycle hooks.</div><div class="line"></div><div class="line"> ç»„ä»¶æŒ‚è½½åæˆ‘ä»¬å¯ä»¥é€šè¿‡currentå±æ€§è·å–DOMçš„å¼•ç”¨ï¼Œç»„ä»¶å¸è½½çš„æ—¶å€™refè¿”å›<span class="literal">null</span>ï¼Œrefæ›´æ–°å‘ç”Ÿåœ¨componentDidMount/componentDidUpdateç”Ÿå‘½å‘¨æœŸçš„é’©å­ä¸­ã€‚</div><div class="line">*<span class="regexp">/</span></div></pre></td></tr></table></figure><p>å†è®¨è®ºä¸€ä¸‹ç»„ä»¶åµŒå¥—refçš„æƒ…å†µ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// - Class Component </span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ZombieWrapper</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  constuctor(props) &#123;</div><div class="line">   <span class="keyword">super</span>(props);</div><div class="line">   <span class="keyword">this</span>.textInput = React.createRef();</div><div class="line">  &#125;</div><div class="line">  componentDidMount() &#123;</div><div class="line">    <span class="comment">// this.textInput.current  </span></div><div class="line">    <span class="comment">// è¿™æœ‰ä¸€ä¸ªç»†å°çš„å·®åˆ«å®é™…ä¸Šï¼Œè¿™é‡Œè·å–çš„æ˜¯React Element ä¸æ˜¯å¾ˆé‡è¦</span></div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (&lt;Cart ref=&#123;this.textInput&#125;/&gt;)      </div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">            </div><div class="line">// function Componentï¼Œå‡½æ•°ç»„ä»¶å¦‚ä½•å‘¢ï¼Ÿ</div><div class="line">function MyStateLessComponent() &#123;</div><div class="line">  return &lt;input/&gt;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class ZombieWrapper extends React.Component &#123;</div><div class="line">  constructor(props) &#123;</div><div class="line">    super(props);      </div><div class="line">    this.inputRef = React.createRef();</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    return (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;MyStateLessComponent ref=&#123;this.inputRef&#125;/&gt;</div><div class="line">      &lt;/div&gt;</div><div class="line">    )     </div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">// è¿™ç§æ–¹å¼ä¸æ˜¯ä¸æ˜¯è¡Œçš„ï¼Œè¦æ”¹æˆclass componentçš„å†™æ³•</div></pre></td></tr></table></figure><p>è¿˜æœ‰ç»™çˆ¶ç»„ä»¶æš´éœ²DOMçš„æƒ…å†µï¼Œå…¶å®ç”¨çš„çœŸå¿ƒä¸å¤šã€‚</p><h4 id="State-vs-Props"><a href="#State-vs-Props" class="headerlink" title="State vs Props"></a>State vs Props</h4><p>Reactæ˜¯å•å‘æ•°æ®æµçš„, propsåœ¨çˆ¶å­ç»„ä»¶ä¹‹é—´ä¼ é€’æµåŠ¨ï¼Œstateæ˜¯ç»„ä»¶å†…éƒ¨è‡ªå·±ç®¡ç†ç»´æŠ¤çš„ï¼Œç±»æ¯”ä¸€ä¸‹ï¼Œpropsæ›´åƒæ˜¯å‡½æ•°çš„å‚æ•°ï¼Œstateæ›´åƒå‡½æ•°å†…éƒ¨å£°æ˜çš„å˜é‡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">component</span>(<span class="params">prrops, ...opts</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> state = &#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> props = &#123;&#125;;</div><div class="line">component(props);  </div><div class="line"><span class="comment">/* </span></div><div class="line"><span class="comment"> ä½¿ç”¨å‡½æ•°æ—¶ä¼šç»™å‡½æ•°ä¼ é€’å‚æ•°ï¼Œå‡½æ•°å†…éƒ¨è¿˜ä¼šå£°æ˜å˜é‡è‡ªå·±å†…éƒ¨, å¯ä»¥ç±»æ¯”Reactçš„ propsï¼Œstateã€‚</span></div><div class="line"><span class="comment"> è®¾è®¡ç»„ä»¶æ˜¯è¦è€ƒè™‘æ¸…æ¥šï¼Œåˆ°åº•æ˜¯propsè¿˜æ˜¯stateå‘¢ã€‚è¿™ä¸ªå…³ç³»åˆ°ç»„ä»¶çš„ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ã€‚</span></div><div class="line"><span class="comment"> å…¶å®å¾ˆç±»ä¼¼ï¼Œæˆ‘ä»¬è®¾è®¡ä¸€ä¸ªå·¥å…·å‡½æ•°æ—¶å€™ï¼Œæˆ‘æˆ‘ä»¬é€‰æ‹©ä¼ é€’å‚æ•°å‘¢ï¼Œè¿˜æ˜¯åœ¨å‡½æ•°å†…éƒ¨å®šä¹‰æ˜¯ä¸€ä¸ªé“ç†ã€‚</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure><h4 id="setState"><a href="#setState" class="headerlink" title="setState"></a>setState</h4><p>  setStateæ˜¯æœ€æœ€é‡è¦çš„APIï¼Œæ•´ä¸ªè§†å›¾çš„æ›´æ–°å›´ç»•ç€è¿™ä¸ªå‡½æ•°ï¼ŒsetStateè¿™ä¸ªAPIç½‘ä¸Šæœ‰å¤ªå¤šæ–‡ç« äº†ï¼Œåé¢æˆ‘ä¼šå†™å†™å‡ºsetStateå…·ä½“çš„å®ç°ï¼Œè¿™é‡Œï¼Œå…ˆå…³æ³¨ä¸€ä¸‹setStateå‡ ç§ç”¨æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> æ˜ç¡®ä¸€ç‚¹ï¼Œåˆ°ç°åœ¨v16.4.0 setStateçš„å®ç°è¿˜æ˜¯åŒæ­¥ï¼Œä»…ä»…æ˜¯è¡¨ç°ä¸Šæœ‰çš„æ—¶å€™æ˜¯å»¶è¿Ÿ(defer)ï¼ï¼è¿™ç§å»¶è¿Ÿçš„è¡¨ç°è®©ä½ è§‰å¾—setStateæ˜¯"å¼‚æ­¥"çš„ï¼Œè‡³äºè¿™ç§å»¶è¿Ÿå…¶å®æœ¬è´¨ä¸Šæ˜¯é€šè¿‡æµç¨‹æ§åˆ¶å®ç°çš„ï¼Œè‡³äºæµç¨‹æ§åˆ¶æ˜¯åŸºäºäº‹åŠ¡(transaction)åšçš„ï¼Œé€šè¿‡åŠ é”å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶äº‹ç‰©å¼€å§‹çš„å‰ç½®è¡Œä¸ºï¼Œåç½®è¡Œä¸ºï¼Œæ¥æ§åˆ¶æµç¨‹å˜åŒ–ï¼Œç±»ä¼¼ä¸­é—´ä»¶çš„æ´‹è‘±æ¨¡å‹ï¼Œè¿™å°±æ˜¯setStateçš„å®ç°ç†è®ºï¼Œåé¢æˆ‘ä¼šå†™å‡ºè¯¦ç»†çš„è¿‡ç¨‹ã€‚(PS v16.0.0 å·²ç»ä¸æ˜¯é€šè¿‡äº‹åŠ¡å®ç°çš„setStateï¼Œä½†æ˜¯äº†è§£ä¹‹å‰çš„setStateå®ç°ä¹Ÿæ˜¯ä¸€ä»¶å¾ˆæœ‰coolæ˜¯äº‹æƒ…ã€‚)</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="comment">// è¨€å½’æ­£ä¼ ï¼Œè¯´å›setStateçš„å‡ ç§å†™æ³•</span></div><div class="line"></div><div class="line"><span class="comment">// 1 - setState(&#123;&#125;) //è¿™æ˜¯å¸¸è§çš„setStateç”¨æ³•</span></div><div class="line"></div><div class="line">setState(&#123;<span class="attr">count</span>: <span class="keyword">this</span>.state.count + <span class="number">1</span>&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 2 - setState(&#123;&#125;ï¼Œfunction()&#123;&#125;);</span></div><div class="line"><span class="comment">/* callbackç”¨æ³•ï¼Œå› ä¸ºsetStateå¤§å¤šæ•°æ—¶é—´ä¼šè¢«å»¶è¿Ÿæ‰§è¡Œï¼Œæˆ‘ä»¬æœ‰æ—¶å€™æƒ³åœ¨stateçœŸå®æ”¹å˜ä¹‹ååšä¸€äº›äº‹æƒ…ï¼Œæ³¨æ„æˆ‘è¯´äº†å¤§å¤šæ•°ä¼šè¢«å»¶è¿Ÿï¼Œå› ä¸ºåœ¨setStateåœ¨setTimeouté‡Œé¢è¡¨ç°çš„æ—¶æ—¶çš„æ”¹å˜ï¼Œæˆ‘è¯´çš„å¾ˆä¸¥è°¨ã€‚</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line">setState(&#123;<span class="attr">count</span>: <span class="keyword">this</span>.state.count + <span class="number">1</span>&#125;, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.count); <span class="comment">// count å·²ç»æ”¹å˜</span></div><div class="line">   <span class="comment">// dosomethingã€‚ã€‚ã€‚ã€‚</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">// 3 - setStaet(() =&gt; &#123;&#125;) ä¼ å…¥å‡½æ•°å½¢å¼</span></div><div class="line"></div><div class="line">setState((prevState, props) = &gt; &#123; <span class="attr">count</span>: prevState.count + <span class="number">1</span>&#125;);</div></pre></td></tr></table></figure><h4 id="forceUpdate"><a href="#forceUpdate" class="headerlink" title="forceUpdate"></a>forceUpdate</h4><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œç»„ä»¶çš„state/propsæ”¹å˜ï¼Œç»„ä»¶ä¼šre-renderï¼Œä½†æ˜¯å¦‚æœä½ çš„ç»„ä»¶ä¾èµ–å…¶ä»–çš„æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨forceUpdateå¼€å¯å¼ºåˆ¶åˆ·æ–°ï¼Œä»–ä¼šè·³è¿‡shouldComponentUpdateè¿™ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­ï¼ŒåŒ…æ‹¬å­ç»„ä»¶ï¼Œå°½é‡å°‘ä½¿ç”¨ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;   ç¬¬ä¸€æ¬¡æ¥è§¦Reactçš„æ—¶å€™æ˜¯è¿˜æ˜¯15å¹´æˆ‘åœ¨å¤©çŒ«å®ä¹ æ—¶å€™ï¼Œæ¯•ä¸šä¹‹åä¸€ç›´å†™Reactæœ‰2å¹´çš„æ—¶é—´äº†ï¼Œä»0.13ç‰ˆæœ¬åˆ°ç°åœ¨16.4.0ä¸€ç›´åœ¨è·Ÿè¿›ï¼Œå¹¶ä¸”æŠ•å…¥å¤§é‡çš„ç²¾åŠ›æ·±å…¥å­¦ä¹ ï¼Œå¯¹Reactç–¯ç‹‚çƒ­çˆ±ï¼Œç—´è¿·ï¼Œè‡ªå·±å¯¹setState, Transaction, Diffè¿‡ç¨‹, Vi
      
    
    </summary>
    
    
  </entry>
  
</feed>
